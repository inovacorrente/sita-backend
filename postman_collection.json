{
	"info": {
		"_postman_id": "sita-backend-api",
		"name": "SITA Backend API - Sistema STRANS",
		"description": "Collection para testar todas as funcionalidades da API do Sistema SITA (Sistema de Tr√¢nsito) da STRANS.\n\nEsta collection inclui:\n- Autentica√ß√£o JWT\n- CRUD de usu√°rios\n- Funcionalidades espec√≠ficas do sistema\n\n**Como usar:**\n1. Configure a vari√°vel {{base_url}} no Environment (ex: http://localhost:8000)\n2. Execute o login para obter o token JWT\n3. O token ser√° automaticamente configurado para as demais requisi√ß√µes\n\n**Grupos de usu√°rios dispon√≠veis:**\n- ADMINISTRADOR\n- ATENDENTE ADMINISTRATIVO\n- FISCAL\n- CONDUTOR",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "sita-backend"
	},
	"item": [
		{
			"name": "üîê Autentica√ß√£o",
			"item": [
				{
					"name": "Login - Obter Token JWT",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Salva o token automaticamente para uso nas pr√≥ximas requisi√ß√µes",
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success && response.data.access) {",
									"        pm.environment.set('jwt_token', response.data.access);",
									"        pm.environment.set('refresh_token', response.data.refresh);",
									"        console.log('Token JWT salvo automaticamente!');",
									"    }",
									"} else {",
									"    console.log('Erro no login:', pm.response.json());",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"matricula\": \"123456789012\",\n    \"password\": \"admin123\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/usuarios/login/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"usuarios",
								"login",
								""
							]
						},
						"description": "Realiza login na API usando matr√≠cula e senha.\n\n**Exemplo de usu√°rios padr√£o:**\n- Administrador: 100000000001 / admin123\n- Atendente: 200000000001 / senha123\n- Fiscal: 300000000001 / senha123\n- Condutor: 400000000001 / senha123\n\n**Resposta de sucesso:**\n```json\n{\n    \"success\": true,\n    \"data\": {\n        \"access\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\",\n        \"refresh\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\",\n        \"user\": {\n            \"matricula\": \"100000000001\",\n            \"nome_completo\": \"Administrador Sistema\",\n            \"email\": \"admin@strans.gov.br\",\n            \"grupos\": [\"ADMINISTRADOR\"]\n        }\n    },\n    \"message\": \"Login realizado com sucesso\"\n}\n```"
					}
				}
			],
			"description": "Endpoints relacionados √† autentica√ß√£o JWT no sistema."
		},
		{
			"name": "üë§ Usu√°rios - Informa√ß√µes Pr√≥prias",
			"item": [
				{
					"name": "Obter Minhas Informa√ß√µes",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{jwt_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/usuarios/me/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"usuarios",
								"me",
								""
							]
						},
						"description": "Obt√©m informa√ß√µes detalhadas do usu√°rio logado.\n\n**Autentica√ß√£o necess√°ria:** Sim\n\n**Resposta de sucesso:**\n```json\n{\n    \"success\": true,\n    \"data\": {\n        \"matricula\": \"100000000001\",\n        \"nome_completo\": \"Administrador Sistema\",\n        \"email\": \"admin@strans.gov.br\",\n        \"cpf\": \"12345678901\",\n        \"telefone\": \"(85) 99999-9999\",\n        \"data_nascimento\": \"1985-01-01\",\n        \"sexo\": \"M\",\n        \"is_active\": true,\n        \"grupos\": [\"ADMINISTRADOR\"],\n        \"data_criacao\": \"2025-01-01T10:00:00Z\"\n    },\n    \"message\": \"Dados do usu√°rio obtidos com sucesso\"\n}\n```"
					}
				},
				{
					"name": "Atualizar Minhas Informa√ß√µes",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{jwt_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"nome_completo\": \"Nome Atualizado\",\n    \"telefone\": \"(85) 88888-8888\",\n    \"data_nascimento\": \"1985-01-01\",\n    \"sexo\": \"M\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/usuarios/me/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"usuarios",
								"me",
								""
							]
						},
						"description": "Atualiza informa√ß√µes do pr√≥prio usu√°rio logado.\n\n**Autentica√ß√£o necess√°ria:** Sim\n\n**Campos edit√°veis:**\n- nome_completo\n- telefone\n- data_nascimento\n- sexo\n\n**Campos N√ÉO edit√°veis:**\n- matricula\n- email\n- cpf\n- grupos\n- is_active"
					}
				}
			],
			"description": "Endpoints para o usu√°rio gerenciar suas pr√≥prias informa√ß√µes."
		},
		{
			"name": "üë• Gest√£o de Usu√°rios",
			"item": [
				{
					"name": "Listar Usu√°rios",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{jwt_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/usuarios/usuarios/?page=1&page_size=10&search=&ordering=nome_completo",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"usuarios",
								"usuarios",
								""
							],
							"query": [
								{
									"key": "page",
									"value": "1",
									"description": "N√∫mero da p√°gina (padr√£o: 1)"
								},
								{
									"key": "page_size",
									"value": "10",
									"description": "Itens por p√°gina (padr√£o: 10, m√°ximo: 100)"
								},
								{
									"key": "search",
									"value": "",
									"description": "Busca por nome, matr√≠cula, email ou CPF"
								},
								{
									"key": "ordering",
									"value": "nome_completo",
									"description": "Ordena√ß√£o: nome_completo, matricula, data_criacao, -nome_completo (desc)"
								}
							]
						},
						"description": "Lista todos os usu√°rios do sistema com pagina√ß√£o e filtros.\n\n**Autentica√ß√£o necess√°ria:** Sim\n**Permiss√µes:** Usu√°rios com acesso de visualiza√ß√£o\n\n**Par√¢metros de consulta:**\n- `page`: P√°gina atual (padr√£o: 1)\n- `page_size`: Itens por p√°gina (padr√£o: 10, m√°x: 100)\n- `search`: Busca textual em nome, matr√≠cula, email ou CPF\n- `ordering`: Campo de ordena√ß√£o (+ asc, - desc)\n\n**Campos de ordena√ß√£o dispon√≠veis:**\n- nome_completo\n- matricula\n- data_criacao\n- email"
					}
				},
				{
					"name": "Criar Usu√°rio",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{jwt_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"nome_completo\": \"Jo√£o Silva Santos\",\n    \"email\": \"joao.silva@strans.gov.br\",\n    \"cpf\": \"12345678901\",\n    \"telefone\": \"(85) 99999-9999\",\n    \"data_nascimento\": \"1990-05-15\",\n    \"sexo\": \"M\",\n    \"password\": \"senha123\",\n    \"groups\": [\"FISCAL\"]\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/usuarios/register/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"usuarios",
								"register",
								""
							]
						},
						"description": "Cria um novo usu√°rio no sistema.\n\n**Autentica√ß√£o necess√°ria:** Sim\n**Permiss√µes:** Apenas administradores podem criar outros administradores\n\n**Campos obrigat√≥rios:**\n- nome_completo\n- email (√∫nico)\n- cpf (√∫nico, 11 d√≠gitos)\n- data_nascimento\n- sexo (M, F, O)\n- password\n\n**Campos opcionais:**\n- telefone\n- groups (lista de grupos)\n\n**Grupos dispon√≠veis:**\n- ADMINISTRADOR\n- ATENDENTE ADMINISTRATIVO  \n- FISCAL\n- CONDUTOR\n\n**Valida√ß√µes:**\n- CPF deve ter 11 d√≠gitos num√©ricos\n- Email deve ser √∫nico\n- Telefone deve estar no formato brasileiro\n- Matr√≠cula √© gerada automaticamente"
					}
				},
				{
					"name": "Obter Usu√°rio por Matr√≠cula",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{jwt_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/usuarios/100000000001/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"usuarios",
								"100000000001",
								""
							]
						},
						"description": "Obt√©m informa√ß√µes detalhadas de um usu√°rio espec√≠fico pela matr√≠cula.\n\n**Autentica√ß√£o necess√°ria:** Sim\n**Permiss√µes:** Pr√≥prio usu√°rio ou usu√°rio com permiss√µes adequadas\n\n**Par√¢metros de URL:**\n- `matricula`: Matr√≠cula do usu√°rio (ex: 100000000001, 300000000002, 400000000001)\n\n**Exemplo de matr√≠cula:**\n- Administrador: 100000000001\n- Fiscal: 300000000001\n- Condutor: 400000000001"
					}
				},
				{
					"name": "Atualizar Usu√°rio",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{jwt_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"nome_completo\": \"Jo√£o Silva Santos Atualizado\",\n    \"telefone\": \"(85) 88888-8888\",\n    \"data_nascimento\": \"1990-05-15\",\n    \"sexo\": \"M\",\n    \"groups\": [\"FISCAL\", \"CONDUTOR\"]\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/usuarios/300000000001/editar/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"usuarios",
								"300000000001",
								"editar",
								""
							]
						},
						"description": "Atualiza informa√ß√µes de um usu√°rio espec√≠fico.\n\n**Autentica√ß√£o necess√°ria:** Sim\n**Permiss√µes:** Pr√≥prio usu√°rio ou administrador\n\n**Campos edit√°veis:**\n- nome_completo\n- telefone\n- data_nascimento\n- sexo\n- groups (apenas administradores)\n\n**Campos N√ÉO edit√°veis:**\n- matricula\n- email\n- cpf\n- password (use endpoint espec√≠fico)\n- is_active (use endpoint espec√≠fico)"
					}
				},
				{
					"name": "Ativar/Desativar Usu√°rio",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{jwt_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"is_active\": false,\n    \"motivo\": \"Usu√°rio solicitou desativa√ß√£o da conta\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/usuarios/ativar-desativar/300000000002/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"usuarios",
								"ativar-desativar",
								"300000000002",
								""
							]
						},
						"description": "Ativa ou desativa um usu√°rio no sistema.\n\n**Autentica√ß√£o necess√°ria:** Sim\n**Permiss√µes:** Apenas administradores\n\n**Campos:**\n- `is_active`: true para ativar, false para desativar\n- `motivo`: Motivo da ativa√ß√£o/desativa√ß√£o (opcional)\n\n**Regras:**\n- Administradores n√£o podem se desativar\n- Usu√°rios desativados n√£o conseguem fazer login\n- Opera√ß√£o √© registrada no log do sistema"
					}
				}
			],
			"description": "Endpoints para gest√£o completa de usu√°rios (CRUD + funcionalidades espec√≠ficas)."
		},
		{
			"name": "üìä Utilit√°rios e Informa√ß√µes",
			"item": [
				{
					"name": "Schema da API",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/schema/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"schema",
								""
							]
						},
						"description": "Obt√©m o schema OpenAPI da aplica√ß√£o.\n\n**Autentica√ß√£o necess√°ria:** N√£o\n\nRetorna a especifica√ß√£o completa da API em formato OpenAPI 3.0, incluindo todos os endpoints, modelos de dados e exemplos."
					}
				},
				{
					"name": "Documenta√ß√£o Swagger",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/docs/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"docs",
								""
							]
						},
						"description": "Acessa a documenta√ß√£o interativa da API via Swagger UI.\n\n**Autentica√ß√£o necess√°ria:** N√£o\n\nInterface web interativa para explorar e testar todos os endpoints da API."
					}
				}
			],
			"description": "Endpoints utilit√°rios para documenta√ß√£o e informa√ß√µes do sistema."
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Script global executado antes de cada requisi√ß√£o",
					"// Verifica se existe token JWT salvo",
					"const token = pm.environment.get('jwt_token');",
					"if (token) {",
					"    console.log('Token JWT encontrado, ser√° usado na requisi√ß√£o');",
					"} else {",
					"    console.log('Nenhum token JWT encontrado. Execute o login primeiro.');",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Script global executado ap√≥s cada requisi√ß√£o",
					"// Log do status da resposta",
					"const statusCode = pm.response.code;",
					"const statusText = pm.response.status;",
					"console.log(`Resposta: ${statusCode} ${statusText}`);",
					"",
					"// Se for erro de autentica√ß√£o, limpa o token",
					"if (statusCode === 401) {",
					"    pm.environment.unset('jwt_token');",
					"    console.log('Token expirado ou inv√°lido. Fa√ßa login novamente.');",
					"}"
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8000",
			"type": "string"
		}
	]
}
